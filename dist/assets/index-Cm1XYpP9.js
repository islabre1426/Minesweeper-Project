(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();const f={mode:{beginner:{rows:9,cols:9,mines:10},intermediate:{rows:16,cols:16,mines:40},expert:{rows:16,cols:30,mines:99}},emoji:{normal:"ðŸ™‚",win:"ðŸ˜Ž",lose:"ðŸ˜µ",mine:"ðŸ’£",flag:"ðŸš©",misflagged:"âŒ",stopwatch:"â±ï¸"}};function A(t,e){return Array(t).fill().map(()=>Array(e).fill(0))}function T(t,e,r){r.textContent="",r.style.gridTemplateColumns=`repeat(${e}, 1.5rem)`;for(let o=0;o<t;o++)for(let s=0;s<e;s++){const n=document.createElement("button");n.dataset.row=o,n.dataset.col=s,r.appendChild(n)}}function q(t,e,r){return t.querySelector(`button[data-row="${e}"][data-col="${r}"]`)}function L(t,e,r){return t[e][r]==="M"}function N(t,e,r,o,s,n){let i=0;const l=new Set,c=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]];for(const[a,d]of c){const u=r+a,g=o+d;u>=0&&u<s&&g>=0&&g<n&&l.add(`${u},${g}`)}for(;i<e;){const a=Math.floor(Math.random()*s),d=Math.floor(Math.random()*n);l.has(`${a},${d}`)||L(t,a,d)||(t[a][d]="M",i++)}}function P(t,e,r){const o=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],s=(n,i)=>{let l=0;for(const[c,a]of o){const d=n+c,u=i+a;d>=0&&d<e&&u>=0&&u<r&&L(t,d,u)&&l++}return l};for(let n=0;n<e;n++)for(let i=0;i<r;i++){if(L(t,n,i))continue;const l=s(n,i);t[n][i]=l>0?l:0}}function I(t,e,r,o,s,n,i,l){const c=q(n,t,e);if(!c||c.classList.contains("revealed")||c.classList.contains("flagged"))return;c.classList.add("revealed");const a=r[t][e];if(a==="M"){c.textContent="ðŸ’£",c.classList.add("mine","mine-hit"),l.onLose(t,e);return}if(i.revealedSafeCells++,i.revealedSafeCells===i.totalSafeCells){l.onWin();return}if(a>0){c.textContent=a,c.classList.add(`n${a}`);return}c.textContent="",W(t,e,r,o,s,n,i,l)}function W(t,e,r,o,s,n,i,l){const c=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]];for(const[a,d]of c){const u=t+a,g=e+d;u>=0&&u<o&&g>=0&&g<s&&I(u,g,r,o,s,n,i,l)}}let M=null,w=0,x=!1;function D(t){x||(x=!0,M=setInterval(()=>{w++,t(w)},1e3))}function S(){clearInterval(M),x=!1}function B(t){S(),w=0,t(w)}function z(t,e){const r=t.querySelectorAll("button");for(const o of r){const s=o.dataset.row,n=o.dataset.col;o.disabled=!0,L(e,s,n)&&!o.classList.contains("flagged")&&(o.textContent=f.emoji.mine,o.classList.add("revealed","mine")),o.classList.contains("flagged")&&!L(e,s,n)&&(o.textContent=f.emoji.misflagged,o.classList.add("misflagged"))}}function F(t,e){const r=t.querySelectorAll("button");for(const o of r){const s=o.dataset.row,n=o.dataset.col;o.disabled=!0,L(e,s,n)&&(o.textContent=f.emoji.flag,o.classList.add("revealed","flagged"))}}const O=document.getElementById("mode-select"),h=document.getElementById("board"),$=document.getElementById("mines"),b=document.getElementById("emoji"),K=document.getElementById("stopwatch");let p,C,y,v,m={firstClick:!0,gameOver:!1,totalSafeCells:0,revealedSafeCells:0};function E(t){const e=f.mode[t];p=e.rows,C=e.cols,y=e.mines,$.textContent=`${f.emoji.mine} ${y}`,m.firstClick=!0,m.gameOver=!1,T(p,C,h),v=A(p,C),B(j),b.textContent=f.emoji.normal}O.addEventListener("change",()=>E(O.value));E("beginner");h.addEventListener("contextmenu",t=>{if(t.preventDefault(),m.gameOver)return;const e=t.target;!e.matches("button")||e.classList.contains("revealed")||(e.classList.contains("flagged")?(e.classList.remove("flagged"),e.textContent="",$.textContent=`${f.emoji.mine} ${++y}`):(e.classList.add("flagged"),e.textContent=f.emoji.flag,$.textContent=`${f.emoji.mine} ${--y}`))});h.addEventListener("click",t=>{if(m.gameOver)return;const e=t.target;if(!e.matches("button"))return;const r=+e.dataset.row,o=+e.dataset.col;m.firstClick&&(B(j),D(j),N(v,y,r,o,p,C),P(v,p,C),m.totalSafeCells=p*C-y,m.revealedSafeCells=0,m.firstClick=!1),I(r,o,v,p,C,h,m,{onLose:()=>{m.gameOver=!0,S(),b.textContent=f.emoji.lose,z(h,v)},onWin:()=>{m.gameOver=!0,S(),b.textContent=f.emoji.win,F(h,v)}})});function j(t){const e=String(Math.floor(t/60)).padStart(2,"0"),r=String(t%60).padStart(2,"0");K.textContent=`${f.emoji.stopwatch} ${e}:${r}`}
